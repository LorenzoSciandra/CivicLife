{"ast":null,"code":"import _regeneratorRuntime from\"/home/michelestaffieri/Documenti/Taass/CivicLife/CivicLife/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/michelestaffieri/Documenti/Taass/CivicLife/CivicLife/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/michelestaffieri/Documenti/Taass/CivicLife/CivicLife/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import'../App.css';import{Button,Grid,Typography}from\"@mui/material\";import basquiaPulito from\"../imgs/logo_CivicLife.png\";import{useNavigate}from\"react-router-dom\";import{exchangeToken,isInstanceOfAuthError}from\"../APIs/OauthAPI\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var LoginChoser=function LoginChoser(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),firstLoad=_useState2[0],setFirstLoad=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),tokenData=_useState4[0],setTokenData=_useState4[1];var getTokenData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(token_cifrato){var tokenResponse;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return exchangeToken(token_cifrato);case 2:tokenResponse=_context.sent;if(isInstanceOfAuthError(tokenResponse)){navigate('/error',{state:{error:tokenResponse}});}else{if(tokenResponse){setTokenData(tokenResponse);navigate('/home',{state:{tokenData:tokenResponse}});}else{console.log('error');}}case 4:case\"end\":return _context.stop();}},_callee);}));return function getTokenData(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(firstLoad){if(window.location.href.includes('token=')&&tokenData===null){var token_cifrato=window.location.href.split(\"token=\")[1].toString();if(token_cifrato!==\"\"){getTokenData(token_cifrato);}}else{console.log(\"token non presente\");}}setFirstLoad(false);},[]);var navigate=useNavigate();var loginWithService=function loginWithService(){window.location.assign('http://172.19.0.10:8080/login');};var loginAsVisitor=function loginAsVisitor(){navigate('/home',{state:{isVisitor:true}});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Grid,{container:true,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,display:\"flex\",justifyContent:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsx(\"img\",{src:basquiaPulito,width:\"320px\",height:\"320px\",alt:'civicLife Logo'})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,display:\"flex\",justifyContent:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsx(Typography,{style:{color:'white',textAlign:'center',fontSize:'4rem'},children:\"LOGIN\"})})]}),/*#__PURE__*/_jsxs(Grid,{container:true,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:6,display:\"flex\",justifyContent:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsx(Button,{onClick:loginWithService,style:{position:'absolute',marginBottom:'100px',borderRadius:35,backgroundColor:\"#21b6ae\",padding:\"18px 36px\",fontSize:\"25px\"},variant:\"contained\",children:\"Accedi\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:6,display:\"flex\",justifyContent:\"center\",alignItems:\"center\",children:/*#__PURE__*/_jsx(Button,{onClick:loginAsVisitor,style:{position:'absolute',marginBottom:'100px',borderRadius:35,backgroundColor:\"#feac0d\",padding:\"18px 36px\",fontSize:\"25px\"},variant:\"contained\",children:\"Ospite\"})})]})]});};export default LoginChoser;","map":{"version":3,"names":["React","useEffect","useState","Button","Grid","Typography","basquiaPulito","useNavigate","exchangeToken","isInstanceOfAuthError","LoginChoser","firstLoad","setFirstLoad","tokenData","setTokenData","getTokenData","token_cifrato","tokenResponse","navigate","state","error","console","log","window","location","href","includes","split","toString","loginWithService","assign","loginAsVisitor","isVisitor","color","textAlign","fontSize","position","marginBottom","borderRadius","backgroundColor","padding"],"sources":["/home/michelestaffieri/Documenti/Taass/CivicLife/CivicLife/frontend/src/Login/LoginChoser.tsx"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport '../App.css';\nimport {Button, Grid, Typography} from \"@mui/material\";\nimport basquiaPulito from \"../imgs/logo_CivicLife.png\"\nimport {useNavigate} from \"react-router-dom\";\nimport {exchangeToken, isInstanceOfAuthError, TokenData} from \"../APIs/OauthAPI\";\n\nconst LoginChoser = () => {\n\n    const [firstLoad, setFirstLoad] = useState(true);\n    const [tokenData, setTokenData] = useState<TokenData| null>(null);\n\n    const getTokenData = async (token_cifrato: string) => {\n        const tokenResponse = await exchangeToken(token_cifrato);\n        if (isInstanceOfAuthError(tokenResponse)) {\n            navigate('/error', {state: {error: tokenResponse}})\n        } else {\n            if (tokenResponse) {\n                setTokenData(tokenResponse)\n                navigate('/home', {state: {tokenData: tokenResponse}})\n            } else {\n                console.log('error')\n            }\n\n        }\n    }\n\n    useEffect(() => {\n        if (firstLoad) {\n                if (window.location.href.includes('token=') && tokenData === null) {\n                    const token_cifrato = window.location.href.split(\"token=\")[1].toString()\n                    if (token_cifrato !== \"\") {\n                        getTokenData(token_cifrato)\n\n                    }\n                } else {\n                    console.log(\"token non presente\")\n                }\n            }\n        setFirstLoad(false)\n    }, [])\n\n    const navigate = useNavigate();\n\n    const loginWithService = () => {\n        window.location.assign('http://172.19.0.10:8080/login')\n    }\n\n\n    const loginAsVisitor = () => {\n        navigate('/home', {state: {isVisitor: true}})\n    }\n\n    return (\n        <>\n            <Grid container>\n                <Grid item xs={12} display=\"flex\" justifyContent=\"center\" alignItems=\"center\">\n                    <img src={basquiaPulito} width=\"320px\" height=\"320px\" alt={'civicLife Logo'}/>\n                </Grid>\n                <Grid item xs={12} display=\"flex\" justifyContent=\"center\" alignItems=\"center\">\n                    <Typography style={{color: 'white', textAlign: 'center', fontSize: '4rem'}}>LOGIN</Typography>\n                </Grid>\n            </Grid>\n            <Grid container >\n                <Grid item xs={6} display=\"flex\" justifyContent=\"center\" alignItems=\"center\">\n                    <Button\n                        onClick={loginWithService}\n                        style={{\n                            position: 'absolute',\n                            marginBottom: '100px',\n                            borderRadius: 35,\n                            backgroundColor: \"#21b6ae\",\n                            padding: \"18px 36px\",\n                            fontSize: \"25px\"\n                        }}\n                        variant=\"contained\">Accedi</Button>\n                </Grid>\n                <Grid item xs={6} display=\"flex\" justifyContent=\"center\" alignItems=\"center\">\n                    <Button\n                        onClick={loginAsVisitor}\n                        style={{\n                            position: 'absolute',\n                            marginBottom: '100px',\n                            borderRadius: 35,\n                            backgroundColor: \"#feac0d\",\n                            padding: \"18px 36px\",\n                            fontSize: \"25px\"\n                        }}\n                        variant=\"contained\">Ospite</Button>\n                </Grid>\n            </Grid>\n        </>\n\n    );\n}\n\nexport default LoginChoser;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}